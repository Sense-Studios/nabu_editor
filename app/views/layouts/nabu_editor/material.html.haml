!!! 5
%html

  / render preloader
  = render partial: 'shared/preloader'

  %head
    %title= t('application.title')

    / pass those values to javascript
    :javascript
      // translations
      window.t = #{raw @t.to_json}

      // owner and users
      var client_id = "#{@user_id}";      // this users id
      var account_id = "#{@account_id}";  // this users account
      var clipcard_id = "";

      // engine mount point
      var mount_point = "#{NABU_EDITOR_MOUNT_POINT}"; // mount point of the engine

      // available themes
      var available_themes = #{NABU_THEMES_AVAILABLE_THEMES.to_json};

      // kaltura
      var kalturaPartnerId = "#{@kaltura_partner_id}";
      var kalturaUiConfigId = "#{@kaltura_uiconfig_id}";

      // kaltura
      var kalturaPartnerId = "#{@owner.kaltura_partner_id}";
      var kalturaUiConfigId = "#{@owner.kaltura_uiconfig_id}";

      // ooyala
      var ooyalaApiKey = "#{@owner.ooyala_api_key}";
      var ooyalePlayerId = "#{@owner.ooyala_player_id}";

      // streamone
      var streamoneAccountId = "#{@owner.streamone_account_id unless @owner.blank?}";
      var streamonePlayerCss = "#{@owner.player_css unless @owner.blank?}";
      var streamoneRelatedJson = "#{@owner.related_json unless @owner.blank?}";

    // start the styles
    = stylesheet_link_tag "nabu_editor/application", :media => "all"
    = javascript_include_tag "nabu_editor/application"

    = csrf_meta_tags

    / looks like the only way to add this lastly
    = stylesheet_link_tag "nabu_editor/admin"
    = stylesheet_link_tag "nabu_editor/jquery.dropdown"

    / final override for right menu -- which still doesnt work
    :css
      .marqer_category {z-index: 100000001 !important;}
      .marqer_category:hover {z-index: 100000001 !important;}
      .dropdown-menu {z-index: 100000001 !important;}

    / favicon
    %link{:rel=>"icon", :type=>"image/png", :href=>"/assets/favicon/Favicon_design.png"}
    %meta{:name=>"viewport", :content=>"width=device-width, initial-scale=0.8"}

  %body

    / yields page
    = yield

    / initialize material design
    :javascript
      $(function() {
        $.material.init()
      })
